
  /* ================================
     THEME TOKENS
  ================================== */
  :root{
    --bg:#0f1115;
    --surface:#161a20;
    --surface-2:#1e2430;
    --text:#e6e9ef;
    --muted:#a7b0c0;
    --primary:#7aa2f7;
    --outline:#293043;
    --danger:#f7768e;
    --ok:#a6e3a1;
    --shadow:0 10px 30px rgba(0,0,0,.35);
    --radius:12px;

  }

  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0;
    background:var(--bg);
    color:var(--text);
    font:14.5px/1.5 system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,Noto Sans,Arial;
  }

  /* CHECKBOX */
  input[type="checkbox"]{
    appearance:none;
    width:18px; height:18px;
    border-radius:4px;
    background:#0f131b;
    border:1px solid var(--outline);
    cursor:pointer; display:inline-block; position:relative;
  }
  input[type="checkbox"]:checked{
    background:var(--primary);
    border-color:var(--primary)
  }
  input[type="checkbox"]:checked::after{
    content:"";
    position:absolute; left:4px; top:0px;
    width:6px; height:12px;
    border:solid #fff; border-width:0 2px 2px 0;
    transform:rotate(45deg);
  }

  /* LAYOUT */
  .app{display:flex; min-height:100vh}

  .sidebar{
    flex:0 0 260px;
    background:var(--surface);
    border-right:1px solid var(--outline);
    padding:14px;
    position:relative;
  }

  .brandbar{
    background:var(--surface);
    padding:8px 6px 5px;
  }
  .brand {
    display: flex;
    align-items: center;
    gap: 10px;
    padding: 8px 6px 0px;
  }
  .brand-desc {
    padding: 0 0 6px 66px;
    border-bottom: 1px solid var(--outline);
  }

  .dot{width:10px; height:10px; border-radius:50%; background:var(--primary); box-shadow:0 0 10px var(--primary)}
  .brand h1{font-size:20px; margin:0; letter-spacing:.3px; color:var(--muted); font-weight:600}

  .nav{margin-top:12px; display:flex; flex-direction:column; gap:6px}
  .nav button{
    display:flex; align-items:center; gap:10px; width:100%;
    text-align:left; padding:10px 12px; border-radius:10px;
    background:transparent; border:1px solid var(--outline);
    color:var(--text); cursor:pointer; transition:.15s;
  }
  .nav button:hover{background:var(--surface-2)}
  .nav button.active{
    border-color:var(--primary);
    box-shadow:inset 0 0 0 1px color-mix(in oklab,var(--primary),transparent 60%);
    background:linear-gradient(180deg,color-mix(in oklab,var(--primary),transparent 89%),transparent)
  }
  .nav .icon{width:18px; height:18px; display:inline-grid; place-items:center}
  .nav .icon svg{width:18px; height:18px; display:block}

  .sidebar-actions{
    margin-top:12px; padding-top:12px; border-top:1px solid var(--outline);
    display:flex; flex-direction:column; gap:8px;
  }
  .sidebar-actions .btn{ width:100%; justify-content:center }

  .main{flex:1 1 auto; padding:20px clamp(16px,3vw,36px); overflow:auto}

  /* TOPBAR is now always visible; CTAs live here */
  .topbar{
    display:flex; align-items:center; gap:10px; margin-bottom:14px
  }
  .topbar-cta{
    display:flex; gap:8px; margin-left:auto;
  }
  .hamburger{
    display:none; width:38px; height:38px; border-radius:10px;
    border:1px solid var(--outline); background:var(--surface);
    color:var(--text); cursor:pointer
  }

  .panel{
    background:var(--surface); border:1px solid var(--outline);
    border-radius:var(--radius); box-shadow:var(--shadow); padding:18px
  }
  .panel h2{margin:0 0 6px; font-size:18px}
  .lipsum{color:var(--muted); margin-bottom:14px}

  .dock-wrap{margin:6px 0 14px}
  .dock{
    display:flex; gap:10px; align-items:stretch; overflow-x:auto; overflow-y:hidden;
    padding:10px; border:1px dashed var(--outline); border-radius:12px;
    background:linear-gradient(180deg, rgba(255,255,255,.02), transparent);
    scroll-snap-type:x mandatory; scroll-padding:10px;
    -webkit-overflow-scrolling: touch;
  }
  .dock::-webkit-scrollbar{height:8px}
  .dock::-webkit-scrollbar-thumb{background:#223049; border-radius:8px}
  .dock.empty{justify-content:center; color:#8591a6; font-size:12.5px; min-height:60px}

  .mini{
    position:relative; width:220px; min-width:220px;
    background:var(--surface-2); border:1px solid var(--outline); border-radius:12px;
    box-shadow:0 6px 18px rgba(0,0,0,.25);
    padding:10px 12px 12px; cursor:pointer;
    transition:.15s ease transform,.15s ease box-shadow,.15s ease border-color,.15s ease opacity;
    scroll-snap-align:start; touch-action:none;
  }
  .mini:hover{transform:translateY(-2px); border-color:var(--primary); box-shadow:0 10px 28px rgba(0,0,0,.3)}
  .mini h4{margin:0 0 6px; font-size:13.5px; letter-spacing:.2px}
  .kv{font-size:12.5px; color:#a9b3c5; line-height:1.4}
  .badges{display:flex; gap:6px; margin-top:8px}
  .badge{font-size:11.5px; padding:3px 8px; border:1px solid var(--outline); border-radius:999px; color:#cbd3e1; background:#0f131b}
  .actions{position:absolute; top:8px; right:8px; display:flex; gap:6px}
  .icon-btn{width:26px; height:26px; border-radius:8px; border:1px solid var(--outline); background:rgba(255,255,255,.03); color:var(--muted); cursor:pointer}
  .icon-btn:hover{border-color:var(--primary); color:var(--text)}
  .mini.dragging{opacity:.9; box-shadow:0 12px 36px rgba(0,0,0,.45); transform:rotate(1deg) scale(1.02) !important}
  .placeholder{width:220px; min-width:220px; border:2px dashed var(--primary); border-radius:12px; opacity:.6; background:transparent}

  .items{display:flex; flex-direction:column; gap:12px}
  .item{border:1px solid var(--outline); border-radius:12px; background:var(--surface-2); overflow:hidden}
  .item-header{
    display:flex; align-items:center; justify-content:space-between; gap:10px;
    padding:10px 12px; background:linear-gradient(180deg, rgba(255,255,255,.02), transparent);
    border-bottom:1px solid var(--outline)
  }
  .item-title{display:flex; align-items:center; gap:8px; min-width:0}
  .title-input{
    background:transparent; border:1px solid transparent; color:var(--text); font-weight:600; letter-spacing:.2px; border-radius:8px; padding:4px 6px; min-width:140px; max-width:100%;
  }
  .title-input:hover{border-color:#39445c}
  .title-input:focus{outline:none; border-color:var(--primary); background:#0f131b}
  .item-actions{display:flex; align-items:center; gap:8px}

  .btn{border:1px solid var(--outline); background:var(--surface); color:var(--text); padding:8px 10px; border-radius:10px; cursor:pointer; font-size:13px}
  .btn:hover{border-color:var(--primary)}
  .btn.primary{border-color:var(--primary)}
  .btn.ghost{background:transparent}
  .btn.small{padding:6px 8px; font-size:12.5px}
  .btn.danger{border-color:var(--danger); color:var(--danger)}
  .btn.ok{border-color:var(--ok); color:var(--ok)}
  .btn.disabled{opacity:.5; pointer-events:none; filter:grayscale(40%)}
  .item-body{padding:14px 12px 16px;}

  .grid{display:grid; gap:12px; grid-template-columns: repeat(3, minmax(140px, 1fr))}
  .grid-2{display:grid; gap:12px; grid-template-columns: repeat(2, minmax(140px, 1fr))}
  .field{display:flex; flex-direction:column; gap:6px; min-width:0}
  .label{font-size:12.5px; color:var(--muted)}
  input[type="text"]{appearance:textfield; padding:10px 12px; border-radius:10px; border:1px solid var(--outline); background:#0f131b; color:#e6e9ef; outline:none; min-width:0}
  select{padding:10px 12px; border-radius:10px; border:1px solid var(--outline); background:#0f131b; color:#e6e9ef; outline:none; min-width:0}
  input::placeholder{color:#5b6576}
  .row{display:flex; gap:12px; flex-wrap:wrap; align-items:center; margin-top: 10px;}
  .switch{display:flex; align-items:center; gap:8px}

  .single{
    border:1px solid var(--outline); border-radius:12px; background:var(--surface-2);
    padding:14px 12px 16px; margin-bottom:12px
  }
  .single h3{margin:0 0 6px; font-size:15px; color:#cbd3e1; letter-spacing:.2px}

  /* ---- BASICS INPUT SIZING ---- */
  #basicsForm .ctrl input{ flex:0 0 6ch; width:3ch; }

  .cardish{
    border:1px solid var(--outline); border-radius:12px; background:#0f131b;
    padding:12px; display:flex; flex-direction:column; gap:10px;
    width:fit-content;
    min-width:unset;
  }
  .cardish .title{font-size:12.5px; color:#9aa5ba; letter-spacing:.2px}
  .ctrl{
    display:flex; align-items:center; gap:8px;
    border:1px solid #2a3246; border-radius:10px; padding:8px 10px; background:#0b0f16;
    width:fit-content;
  }
  .ctrl input{
    flex:0 0 3ch; width:3ch; background:transparent; border:none; outline:none; color:var(--text); font-size:15px; min-width:0;
  }
  .unit{font-size:12px; padding:3px 8px; border:1px solid var(--outline); border-radius:999px; background:#131826; color:#cbd3e1; white-space:nowrap;}
  .hint{font-size:12px; color:#7783a0}
  .pill-note{
    display:inline-flex; align-items:center; gap:6px; padding:6px 10px;
    border:1px dashed #33405b; border-radius:999px; color:#aab6cc; font-size:12px;
    background:rgba(122,162,247,.06);
  }

  /* ===============================
     BASICS LAYOUT (paired rows)
  ================================== */
  .basics-grid{
    display:grid;
    gap:12px;
    grid-template-columns: repeat(3, minmax(160px, 1fr));
    grid-template-areas:
      "age life retire"
      "spage splife spret";
    align-items:start;
  }
  .cardish.age      { grid-area: age; }
  .cardish.life     { grid-area: life; }
  .cardish.retire   { grid-area: retire; }
  .cardish.sp-age   { grid-area: spage; }
  .cardish.sp-life  { grid-area: splife; }

  /* 2-column breakpoint */
  @media (max-width: 980px){
    .basics-grid{
      grid-template-columns: repeat(2, minmax(160px, 1fr));
      grid-template-areas:
        "age life"
        "retire retire"
        "spage splife"
        "spret spret";
    }
  }

  /* 1-column breakpoint */
  @media (max-width: 429px){
    .basics-grid{
      grid-template-columns: 1fr;
      grid-template-areas:
        "age"
        "spage"
        "life"
        "splife"
        "retire"
        "spret";
    }
  }

  /* stacked add-ons below the grid */
  .basics-addons{
    display:flex;
    flex-direction:column;
    gap:12px;
    margin-top:12px;
    max-width:520px;
  }

/* === iOS Safari select normalization ===
   Fixes thin <select> controls on iPhone where default UI is shorter than text inputs.
   Ensures consistent vertical height with inputs and adequate touch target.
*/
select {
  -webkit-appearance: none;
  appearance: none;
  line-height: 1.25;
}

/* Add back custom â–¼ arrow for selects after removing iOS default */
select {
  position: relative;
  background-image: url("data:image/svg+xml;utf8,<svg fill='%23a7b0c0' height='14' viewBox='0 0 20 20' width='14' xmlns='http://www.w3.org/2000/svg'><path d='M5.516 7.548L10 12.032l4.484-4.484-1.06-1.06L10 9.91 6.576 6.488z'/></svg>");
  background-repeat: no-repeat;
  background-position: right 10px center;
  background-size: 14px;
  padding-right: 32px; /* room for the arrow */
}

/* Prefer a minimum touch target on touch devices */
@media (hover: none) and (pointer: coarse) {
  select {
    min-height: 44px;            /* Apple's recommended minimum tap size */
    padding-top: 10px;
    padding-bottom: 10px;
  }
}

/* Extra nudge for iOS WebKit */
@supports (-webkit-touch-callout: none) {
  select {
    min-height: 44px;
  }
}  
  .panel-footer{margin-top:16px; display:flex; justify-content:space-between; align-items:center; gap:10px}
  .panel-footer .left{display:flex; align-items:center; gap:10px}

  /* Screen-reader-only utility (keep semantic legend, hide visually) */
  .sr-only{
    position:absolute !important;
    width:1px; height:1px;
    padding:0; margin:-1px;
    overflow:hidden; clip:rect(0,0,0,0);
    white-space:nowrap; border:0;
  }
  /* Visible inline caption that sits to the left of the first option */
  .legend-inline{
    display:inline-block;
    margin-right:8px;
    font-size:12.5px;
    color:var(--muted);
    padding:0 6px;
    line-height:1;
  }

  .segmented{
    display:inline-flex; gap:8px; padding:6px; border:1px solid var(--outline); border-radius:999px;
    background:linear-gradient(180deg, rgba(255,255,255,.02), transparent);
    box-shadow:inset 0 0 0 1px rgba(255,255,255,.02);
    flex-wrap:wrap; align-items:center;   }
  .segmented input{ position:absolute; opacity:0; width:1px; height:1px; overflow:hidden; }
  .segmented label{
    position:relative; display:inline-flex; align-items:center; justify-content:center;
    padding:8px 12px; border-radius:999px; border:1px solid var(--outline);
    background:#0f131b; color:#cbd3e1; font-size:12.5px; cursor:pointer; user-select:none; transition:.15s ease;
  }
  .segmented label:hover{ border-color:#39445c }
  .segmented input:focus + label{ outline:2px solid color-mix(in oklab, var(--primary), transparent 60%); outline-offset:2px }
  .segmented input:checked + label{
    border-color:var(--primary); color:var(--text);
    box-shadow:inset 0 0 0 1px color-mix(in oklab,var(--primary),transparent 60%);
    background:linear-gradient(180deg,color-mix(in oklab,var(--primary),transparent 89%), transparent);
  }

  /* RESPONSIVE (sidebar/mobile) */
  @media (max-width: 820px){
    .app{display:block}
    .sidebar{position:fixed; inset:0 auto 0 0; width:76vw; max-width:320px; transform:translateX(-105%); transition:.2s ease transform; z-index:30}
    .sidebar.open{transform:none}
    .overlay{position:fixed; inset:0; background:rgba(0,0,0,.35); backdrop-filter:saturate(140%) blur(2px); display:none; z-index:20}
    .overlay.show{display:block}
    .hamburger{display:inline-grid; place-items:center}
  }

  .spacer{flex:1}
  .hidden{display:none !important}
  .subtle{font-size:12px; color:#9aa5ba}

  @media (max-width: 960px){ #genericSingle{ grid-template-columns: repeat(2, minmax(160px, 1fr)); } }
  @media (max-width: 560px){ #genericSingle{ grid-template-columns: 1fr; } }

  .json-box{
    margin-top:12px; padding:12px; border:1px solid var(--outline); border-radius:10px; background:#0b0f16; box-shadow:var(--shadow);
    max-height:40vh; overflow:auto; white-space:pre-wrap;
    font:12.5px/1.45 ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace; color:#d1e7ff;
  }

  .toast{
    position:fixed; bottom:16px; right:16px;
    background:#0b0f16; color:#e6e9ef; border:1px solid var(--outline);
    border-radius:10px; padding:10px 12px; box-shadow:0 12px 36px rgba(0,0,0,.45);
    display:none; align-items:center; gap:10px;
  }
  .toast.show{display:flex}
  .toast.ok{border-color:var(--ok)}
  .toast.err{border-color:var(--danger)}

  .panel-header{
    display:flex; align-items:center; gap:10px; margin-bottom:6px;
  }

  @media (max-width: 820px){
    .panel-header{
      position: sticky; top: 8px; z-index: 5;
      background: var(--surface);
      padding-top: 6px;
    }
    .panel-header::after{
      content:""; position:absolute; left:-18px; right:-18px; bottom:-6px; height:1px;
      background: var(--outline); opacity:.6; display:block;
    }
  }

  .mobile-cta{ display:none; }
  @media (max-width: 560px){
    .mobile-cta{
      position: sticky; bottom: 0; z-index: 4;
      display:flex; justify-content:flex-end; gap:8px;
      margin-top: 12px; padding: 10px 0;
      background: linear-gradient(180deg, transparent, rgba(0,0,0,.15));
    }
  }

  /* ===== Growth Rates sections (new) ===== */
  .gr-section{
    border:1px solid var(--outline);
    border-radius:12px;
    background:var(--surface-2);
    padding:14px;
    margin:12px 0;
  }
  .gr-head{
    display:flex; 
    flex-direction: column;
    align-items: flex-start;
    gap:6px;
    margin-bottom:12px;
  }
  .gr-title{
    margin:0; font-size:16px; letter-spacing:.2px; color:#cbd3e1;
  }

  /* Percent inputs: just big enough for values like "12.0%" / "100.0%" */
  input.pct{
    inline-size: 150px;
    padding-inline: 8px;
    text-align: right;
  }

  /* =========================
     MODAL (help me choose)
  ==========================*/
  .modal-backdrop{
    position:fixed; inset:0;
    background:rgba(0,0,0,.45);
    display:none;
    z-index:90;
  }
  .modal{
    position:fixed; left:50%; top:10%;
    transform:translateX(-50%);
    width:min(720px, 92vw);
    background:var(--surface);
    border:1px solid var(--outline);
    border-radius:12px;
    box-shadow:0 18px 60px rgba(0,0,0,.55);
    padding:14px;
    display:none;
    z-index:91;
  }
  .modal.show, .modal-backdrop.show{ display:block; }
  .modal-header{ display:flex; align-items:center; justify-content:space-between; gap:10px; margin-bottom:8px; }
  .modal-title{ margin:0; font-size:16px; color:#cbd3e1; }
  .modal-body{ display:flex; flex-direction:column; gap:12px; }
  .modal-footer{ display:flex; justify-content:flex-end; gap:8px; margin-top:8px; }

  .modal .grid-2{ grid-template-columns: repeat(2, minmax(120px, 1fr)); }
  @media (max-width:560px){ .modal{ top:6%; } }

  .cardish.sp-retire { grid-area: spret; }

  .panel-next-footer{
    display:flex;
    flex-wrap: nowrap;
    justify-content:flex-start;
    align-items:center;
    gap:12px;
    margin-top:10px;
    padding-top:6px;
  }
  .panel-next-footer #backSectionBtn{}


  /* Shared left-nav style for footer nav buttons */
  .navbtn{ /* ensure intrinsic width */
    width:auto;

    display:flex; align-items:center; gap:10px;
    text-align:left; padding:10px 12px; border-radius:10px;
    background:var(--surface); border:1px solid var(--outline);
    color:var(--text); cursor:pointer; transition:.15s;
  }
  .navbtn:hover{ background:var(--surface-2) }
  .navbtn .icon{ width:20px; height:20px; display:inline-flex }
  .navbtn span{ font-weight:500 }


/* Modal close X */
.modal-x{
  position:absolute;
  right:12px;
  top:10px;
  border:none;
  background:transparent;
  font-size:20px;
  line-height:1;
  cursor:pointer;
  color:#f5f5f5; /* light color for dark mode */
}
.modal-x:hover{ color:#fff; }
.modal-x:focus{ outline:2px solid #aaa; outline-offset:2px; }
.modal-x:focus{outline:2px solid #777;outline-offset:2px}

/* Custom ROI Years (Liquid) */
.custom-rows { margin-top: 8px; padding: 8px 10px; border: 1px dashed var(--fg-3); border-radius: 10px; }
.custom-rows.hidden { display: none; }
.custom-rows .rows-head { font-size: 12.5px; margin-bottom: 8px; }
.triple-row .field { flex: 0 0 auto; }
.triple-row .field select { width: 120px; }
.triple-row .field input { width: 80px; text-align: right; }
.triple-row .field { margin: 0; }
.triple-row .field .label { font-size: 12.5px; }
.triple-row .field input { width: 100%; text-align: right; }
.btn-row { margin-top: 6px; display: flex; gap: 8px; }
.rem-row { border: 0; background: transparent; cursor: pointer; width: 28px; height: 28px; line-height: 28px; text-align: center; border-radius: 8px; color: #ccc; }
.rem-row:hover { background: var(--bg-2); color: #fff; }


.triple-row {
  display: flex !important;
  flex-wrap: nowrap !important;
  gap: 8px !important;
  align-items: flex-end !important;
  margin-bottom: 6px !important;
}
.triple-row .field { flex: 0 0 auto !important; margin: 0 !important; }
.triple-row .field select { width: 120px !important; }
.triple-row .field input { width: 80px !important; text-align: right !important; }


/* Compact fields in Liquid -> Customize ROI Years */
.custom-rows .triple-row { display: flex; flex-wrap: nowrap; gap: 8px; align-items: flex-end; margin-bottom: 6px; }
.custom-rows .triple-row .field { flex: 0 0 auto; }
.custom-rows .triple-row .field select.year-compact { width: 120px !important; }
.custom-rows .triple-row .field input.pct.small { width: 80px !important; text-align: right !important; }


/* === ROI Custom Year Rows: tabular header style === */
.triple-row {
  display: grid;
  grid-template-columns: 1fr 1fr 1fr auto;
  gap: 8px;
  align-items: end;
}
.triple-row .field { min-width: 0; }
.triple-row .field .label { display: block; margin-bottom: 2px; font-weight: 600; }

/* First row acts like headers */
.triple-row.header-row .field .label {
  opacity: 0.9;
}

/* Remove excess top spacing when there is no label */
.triple-row:not(.header-row) .field .label { display: none; }

/* Keep the remove button visible in dark mode */
.rem-row {
  opacity: 0.85;
}
